
CREATE PROCEDURE SP_COMISSAO @DT1 DATETIME, @DT2 DATETIME
AS BEGIN
SELECT V.CODVEN, V.NOME,
SUM(P.VLR_TOTAL) AS TOT_VENDIDO,
SUM(P.VLR_TOTAL * V.PORC_COMISSAO/100) AS COMISSAO
FROM
PEDIDOS P JOIN VENDEDORES V ON P.CODVEN=V.CODVEN
WHERE
P.DATA_EMISSAO BETWEEN @DT1 AND @DT2
GROUP BY V.CODVEN, V.NOME;
END
